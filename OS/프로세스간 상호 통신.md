# Interprocess Communication

### 동시에 실행되는 프로세스

 동시에 실행될 수 있는 프로세스는 독립적인 프로세스 또는 협력적인 프로세스 중 하나입니다.
##### 독립적인 프로세스
- 다른 프로세스와 데이터를 공유하지 않는 경우
##### 협력적인 프로세스
- 다른 프로세스에 영향을 미치거나 영향을 받을 수 있는 경우
- 협력 과정 중 다른 프로세스와 데이터를 공유하는 모든 프로세스

### IPC: 프로세스간 통신  
협력 프로세스간 데이터 교환을 위해선 IPC 메커니즘이 필요합니다.
##### IPC의 두 가지 기본 모델
• 공유 메모리  
• 메시지 전달

![](https://i.imgur.com/QCaPwez.png)

# 공유 메모리 시스템에서의 IPC

▪ 생산자-소비자 문제를 고려합니다  
• 협력 프로세스의 개념을 설명합니다.  
• 프로세스를 협력하기 위한 공통적인 패러다임.  
▪ 생산자-소비자 문제:  
• 생산자는 소비자가 소비하는 정보를 생산합니다.  
• 예를 들면,  
- 컴파일러는 어셈블리 코드를 생성하고 어셈블리는 이 코드를 소비합니다.  
- 웹 서버는 HTML 파일을 생성하고 브라우저는 이 파일을 소비합니다.

▪ 공유 메모리를 사용한 솔루션:  
• 생산자와 소비자가 동시에 실행할 수 있도록 합니다.  
• 항목의 버퍼를 사용할 수 있도록 합니다,  
- 프로듀서는 버퍼를 채울 수 있습니다  
- 소비자는 버퍼를 비울 수 있습니다.  
• 공유 메모리는 메모리의 한 영역입니다  
- 그것은 생산자와 소비자 프로세스에 의해 공유됩니다.

▪ 공유 버퍼 정의  
• 생산자와 소비자 프로세스가 공유하는 메모리 영역에서.

![](https://i.imgur.com/CFQN6vu.png)



![](https://i.imgur.com/es5ucGw.png)

![](https://i.imgur.com/QWgweFc.png)


# 메시지 전달 시스템에서의 IPC

▪ 공유 메모리를 사용하는 방식  
• 이러한 프로세스가 메모리의 한 영역을 공유해야 하며, 다음과 같은 것을 요구합니다  
• 공유 메모리에 접근하고 조작하기 위한 코드  
- 응용 프로그램 프로그래머가 명시적으로 작성합니다.  
▪ 메시지 전달:  
• O/S는 프로세스를 협력할 수 있는 수단을 제공합니다  
- 메시지 passing 시설을 통해 서로 통신할 수 있습니다.

▪ 메시지 전달 시설의 두 가지 운영:  
• send(message)  
• receive(message)
![](https://i.imgur.com/jPBfHlF.png)

![](https://i.imgur.com/PW19Mkz.png)

▪ 통신 링크:  
• 𝑃와 𝑄의 두 프로세스가 통신을 원한다면,  
- 서로 메시지를 주고 받아야 합니다  
• 이 통신 링크는 다양한 방식으로 구현할 수 있습니다.  
- 직간접적인 의사소통.  
- 동기식 및 비동기식 통신.  
- 자동 또는 명시적 버퍼링.

▪ 직접적인 의사소통 하에,  
• 커뮤니케이션을 원하는 각 프로세스  
- 통신의 수신자 또는 발신자의 이름을 명시적으로 지정해야 합니다.  
• 이 계획의 기본 요소는 다음과 같습니다:  
- send(𝑃, 메시지) – 𝑃를 처리하기 위한 메시지를 보냅니다.  
- receive(𝑄, 메시지) – 프로세스 𝑄로부터 메시지를 수신합니다.

▪ 이 체계에서 통신 링크의 속성:  
• 링크가 자동으로 설정됩니다  
• 링크는 정확히 두 개의 프로세스와 연결됩니다.  
• 각 프로세스 쌍 사이에는 정확히 하나의 링크가 있습니다.

▪ 간접적인 의사소통으로,  
• 메시지는 우편함 또는 포트로 송수신됩니다.  
• 편지함(포트라고도 함)  
- 추상적으로 객체로 볼 수 있습니다  
- 프로세스별로 메시지를 배치할 수 있는 위치와  
- 메시지를 제거할 수 있습니다.  
• 이 계획의 기본 요소는 다음과 같습니다:  
- send(𝐴, 메시지) – 편지함 𝐴로 메시지를 보냅니다.  
- receive(𝐴, 메시지) – 편지함 𝐴에서 메시지를 수신합니다.

이 체계에서 통신 링크의 속성:  
• 한 쌍의 프로세스 사이에 링크가 설정됩니다  
- 쌍의 두 구성원 모두가 공유 편지함을 가지고 있는 경우에만 해당됩니다.  
• 링크는 두 개 이상의 프로세스와 연결될 수 있습니다.  
• 각 프로세스 쌍 사이에 여러 개의 서로 다른 링크가 존재할 수 있습니다  
- 각각의 링크가 하나의 우편함에 해당합니다.

OS는 프로세스가 다음과 같은 작업을 수행할 수 있는 메커니즘을 제공합니다:  
• 새 편지함을 만듭니다.  
• 편지함을 통해 메시지를 보내고 받습니다.  
• 편지함을 삭제합니다.

▪ 구현을 위한 다양한 설계 옵션:  
• 차단 또는 비 blocking: 동기식 또는 비동기식  
• 발신 차단: 메시지가 수신될 때까지 발신인이 차단됩니다.  
• 차단하지 않는 발송: 보낸 사람이 메시지를 보내고 계속합니다.  
• 수신 차단: 메시지를 사용할 수 있을 때까지 수신기가 차단합니다.  
• Non-Blocking Receive: 수신기가 유효한 메시지 또는 null 메시지를 검색합니다.

# Examples of IPC Systems
▪ IPC 시스템의 예  
• 공유 메모리: POSIX 공유 메모리  
- POSIX: 휴대용 운영체제 인터페이스(uniX용)  
• 메시지 전달: 파이프  
- 유닉스 시스템의 초기 IPC 메커니즘 중 하나입니다.

POSIX 공유 메모리  
• 메모리 mapped 파일을 사용하여 구성하고 있습니다,  
- 공유 메모리 영역을 파일과 연결합니다  
• 먼저 공유 메모리 개체를 만듭니다:  
- fd = shm_open(이름, O_CREAT | ORDWR, 0666);  
• 개체 크기를 바이트 단위로 구성합니다:  
- - ftruncate(fd, 4096);  
• 마지막으로 메모리 매핑 파일을 설정합니다:  
- mmap(0, SIZE, PROT_READ | PROT_WRITE, MAP_SHARED, fd, 0);

![](https://i.imgur.com/ozAAmDz.png)

![](https://i.imgur.com/4etGjLx.png)


![](https://i.imgur.com/KZAFxJf.png)
![](https://i.imgur.com/0rLWo8K.png)

▪ 파이프는  
• 초기 유닉스 시스템에서 최초의 IPC 메커니즘 중 하나입니다.  
• 파이프는 두 프로세스가 통신할 수 있도록 하는 도관 역할을 합니다.  
▪ 파이프 구현의 네 가지 문제:  
• 파이프는 단방향 또는 양방향 통신이 가능합니까?  
• 양방향 통신의 경우 반이중입니까 아니면 전이중입니까?  
• 의사소통 과정 사이에 관계가 있어야 합니까?  
- 부모 자식 같은  
• 파이프가 네트워크를 통해 통신할 수 있습니까?

▪ 두 가지 일반적인 파이프 유형:  
• 일반 파이프:  
- 생성한 프로세스 외부에서 액세스할 수 없습니다.  
- 일반적으로 부모 프로세스는 파이프를 생성하여 사용합니다  
자식 프로세스가 만든 프로세스와 의사소통합니다.  
• 명명된 파이프:  
- 부모-자녀 관계 없이 접근할 수 있습니다

▪ 일반 파이프  
• 두 프로세스가 생산자와 소비자의 방식으로 소통할 수 있도록 합니다.  
- 생산자가 파이프의 한쪽 끝에 쓰기(쓰기 끝)  
- 소비자가 다른 쪽 끝에서 읽습니다(읽기 끝)  
• 단방향: 단방향 통신만 가능합니다.  
• 양방향 통신? 두 개의 파이프를 사용합니다!

![](https://i.imgur.com/YEH8bi6.png)

▪ UNIX 시스템에서는,  
• 일반 파이프는 다음과 같은 기능을 사용하여 구성됩니다:  
- 파이프(intfd[])  
- fd[0]: 파이프의 읽기 끝  
- fd[1]: 쓰기 끝

![](https://i.imgur.com/vINDwvG.png)
![](https://i.imgur.com/oiJJIs5.png)

# 클라이언트-서버 시스템에서의 통신

▪ 클라이언트-서버 시스템의 다른 두 가지 전략  
• 소켓  
- 통신을 위한 엔드포인트로 정의됩니다.  
• RPC(원격 프로시저 호출)  
- 네트워크 시스템의 프로세스 간 절차 호출을 추상화합니다.

▪ 소켓은  
• 포트 번호와 연결된 IP 주소로 식별됩니다.

![](https://i.imgur.com/coLXDGq.png)

▪ 자바는 제공합니다  
• 소켓에 대한 훨씬 쉬운 인터페이스와  
• 세 가지 유형의 소켓을 제공합니다  
- 소켓 클래스: 연결 중심(TCP)  
- DataagramSocket 클래스: 무연결(UDP)  
- MulticastSocket 클래스: 여러 수신자

![](https://i.imgur.com/siQAa11.png)

![](https://i.imgur.com/y0K6kED.png)

▪ RPC(Remote Procedure Call)
• 원격 서비스의 가장 일반적인 형태 중 하나입니다.  
• 프로시저 호출 메커니즘을 추상화하는 방법으로 설계되었습니다  
- 네트워크 연결이 있는 시스템 간에 사용할 수 있습니다.  
• 클라이언트가 원격 호스트에서 프로시저를 호출합니다  
- 로컬에서 절차를 호출하기 때문입니다.

▪ RPC 시스템  
• 통신을 허용하는 세부 정보를 숨깁니다  
- 고객 측에 스터브를 제공함으로써.  
• 클라이언트 측 스터브는 서버를 위치시키고  
- 매개변수를 마셜링합니다.  
• 서버 측 스터브가 이 메시지를 받았습니다,  
- Marshalled 파라미터의 포장을 풀고  
- 서버에서 절차를 수행합니다.